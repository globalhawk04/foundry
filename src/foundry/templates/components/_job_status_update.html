<!-- FILE: frontend/components/_job_status_update.html -->
{#
  This is the partial response from the status endpoint.
  It replaces the inner content of the poller card.
  Expects:
  - status: A dictionary from get_status() with 'progress' and 'message'.
#}
<div class="foundry-poller-content">
    <h4>{{ title }}</h4>
    <div class="progress-bar-container">
        <div class="progress-bar" style="width: {{ status.progress }}%;"></div>
    </div>
    <p class="status-message">{{ status.message }}</p>

    {# This tells HTMX to stop polling when the job is no longer in progress #}
    {% if status.status != 'in_progress' %}
        <script>
            htmx.find("#job-poller-{{ job_id }}").removeAttribute('hx-trigger');
            // You could also emit a custom event here for other JS to listen to
            // htmx.trigger("#job-poller-{{ job_id }}", "jobComplete");
        </script>
        <p><strong>Status: {{ status.status | capitalize }}</strong></p>
    {% endif %}
</div>
